"0","#Problem 3c"
"0","oneX2 = function(x){"
"0","  #Define null model to generate data"
"0","  null_model = glmer(y ~ 1 + (1|f) + (1|obs), family=""poisson"", data = p3_3)"
"0","  simy = simulate(null_model)$sim_1"
"0","  "
"0","  #Make alternative model from data simulated by null"
"0","  alt_model = glmer(simy ~ x + (1|f) + (1|obs), family=""poisson"", data = p3_3)"
"0","  #Return the LRT statistic"
"0","  x2 = drop1(alt_model, test=""Chisq"")$LRT[2]"
"0","  "
"0","  return(x2)"
"0","}"
"0","#Now, perform bootstrap"
"0","set.seed(4)"
"0","if (!exists('bag_3c')) {"
"0","  #Perform the bootstrap"
"0","  bag_3c = unlist(parallel::mclapply(1:4000,oneX2))"
"0","}"
"0","bag_df <- as.data.frame(bag_3c)"
"0","#Now find the p-value"
"0","bag_df$bag_3c[bag_df$bag_3c<0] = 0.0"
"0","pval = mean(bag_df$bag_3c >= 257.73)"
"0","paste(""The p-value for the parametric bootstrap test is: "",pval)"
"1","[1]"
"1"," ""The p-value for the parametric bootstrap test is:  0"""
"1","
"
"0","#Plot the null distribution"
"0","hist(bag_df$bag_3c, freq = FALSE, breaks = 30, xlab = ""-2 loglik ratio"", main = """")"
